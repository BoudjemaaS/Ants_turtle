<pre><font color="#007f69">globals</font><font color="#000000">[<br />  coo-x<br />  coo-y<br /><br />  flag-patch<br />  target-x<br />  target-y<br />  <br />  prev-turtle-x<br />  prev-turtle-y<br />]<br /><br /></font><font color="#007f69">to</font><font color="#000000"> clear<br />  </font><font color="#0000aa">set</font><font color="#000000"> coo-x </font><font color="#963700">25</font><font color="#000000"> <br />  </font><font color="#0000aa">set</font><font color="#000000"> coo-y </font><font color="#963700">25</font><font color="#000000"><br /> <br />  </font><font color="#0000aa">resize-world</font><font color="#000000"> ((</font><font color="#963700">-1</font><font color="#000000">)</font><font color="#660096">*</font><font color="#000000">(coo-x)) coo-x ((</font><font color="#963700">-1</font><font color="#000000">)</font><font color="#660096">*</font><font color="#000000">(coo-y)) coo-y<br />  </font><font color="#0000aa">clear-turtles</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">]<br />  <br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> new-turtle<br /> <br />  </font><font color="#0000aa">clear-turtles</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> prev-turtle-x (</font><font color="#963700">-25</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">51</font><font color="#000000">)<br />  </font><font color="#0000aa">set</font><font color="#000000"> prev-turtle-y (</font><font color="#963700">-25</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">51</font><font color="#000000">)<br />  </font><font color="#0000aa">create-turtles</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [ <br />  </font><font color="#0000aa">setxy</font><font color="#000000"> prev-turtle-x prev-turtle-y<br />  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;turtle&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000"><br />  ]<br />    <br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to</font><font color="#000000"> reset-pos-turtle<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">[<br />    </font><font color="#0000aa">setxy</font><font color="#000000"> prev-turtle-x prev-turtle-y <br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> pick-up-turtle<br /></font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">mouse-down?</font><font color="#000000"> [<br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [</font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]<br />  ]<br /><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to</font><font color="#000000"> new-patch<br />  <br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">]<br />  </font><font color="#0000aa">set</font><font color="#000000"> target-x (</font><font color="#963700">-25</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">51</font><font color="#000000">)<br />  </font><font color="#0000aa">set</font><font color="#000000"> target-y (</font><font color="#963700">-25</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">51</font><font color="#000000">)<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> target-x target-y [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]<br />  </font><font color="#0000aa">set</font><font color="#000000"> flag-patch </font><font color="#963700">true</font><font color="#000000"><br />  <br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to</font><font color="#000000"> move-turtle<br />  </font><font color="#0000aa">if</font><font color="#000000"> flag-patch </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000">[<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />    <br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">distancexy</font><font color="#000000">  target-x target-y </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">[<br />      </font><font color="#0000aa">face</font><font color="#000000"> (</font><font color="#660096">patch</font><font color="#000000"> target-x target-y)<br />      </font><font color="#0000aa">forward</font><font color="#000000"> </font><font color="#963700">0.01</font><font color="#000000"><br />        </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">] <br />    ]<br />      [</font><font color="#0000aa">set</font><font color="#000000"> flag-patch </font><font color="#963700">false</font><font color="#000000">]<br /><br /> ]<br /> </font><font color="#0000aa">tick</font><font color="#000000"><br />] <br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to</font><font color="#000000"> turtle-draw<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> shape-draw </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;square&quot;</font><font color="#000000">[<br />    draw-square  <br />  ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> shape-draw </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;triangle&quot;</font><font color="#000000">[<br />    draw-triangle<br />  ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> shape-draw </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;circle&quot;</font><font color="#000000">[<br />    draw-circle<br />  ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> shape-draw </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;star&quot;</font><font color="#000000">[<br />    draw-star<br />  ]<br />  <br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to</font><font color="#000000"> draw-square<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">[<br />    </font><font color="#0000aa">face</font><font color="#000000"> (</font><font color="#660096">patch</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)<br />    </font><font color="#0000aa">repeat</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">[<br />      </font><font color="#0000aa">let</font><font color="#000000"> temp-x </font><font color="#660096">xcor</font><font color="#000000"> <br />      </font><font color="#0000aa">let</font><font color="#000000"> temp-y </font><font color="#660096">ycor</font><font color="#000000"> <br />      </font><font color="#0000aa">right</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000"><br />      <br />      </font><font color="#0000aa">while</font><font color="#000000"> [</font><font color="#660096">distancexy</font><font color="#000000"> temp-x temp-y </font><font color="#660096">&lt;</font><font color="#000000"> size-shape][<br />        </font><font color="#0000aa">forward</font><font color="#000000"> </font><font color="#963700">0.001</font><font color="#000000"><br />        </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]<br />      ]<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br />  <br /><br /></font><font color="#007f69">to</font><font color="#000000"> draw-triangle<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">[<br />    </font><font color="#0000aa">face</font><font color="#000000"> (</font><font color="#660096">patch</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)<br />    </font><font color="#0000aa">repeat</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000">[<br />      </font><font color="#0000aa">let</font><font color="#000000"> temp-x </font><font color="#660096">xcor</font><font color="#000000"> <br />      </font><font color="#0000aa">let</font><font color="#000000"> temp-y </font><font color="#660096">ycor</font><font color="#000000"> <br />      </font><font color="#0000aa">right</font><font color="#000000"> </font><font color="#963700">120</font><font color="#000000"><br />      </font><font color="#0000aa">while</font><font color="#000000"> [</font><font color="#660096">distancexy</font><font color="#000000"> temp-x temp-y </font><font color="#660096">&lt;</font><font color="#000000"> size-shape][<br />        </font><font color="#0000aa">forward</font><font color="#000000"> </font><font color="#963700">0.001</font><font color="#000000"><br />        </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]<br />      ]<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> draw-circle<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">[<br />    </font><font color="#0000aa">face</font><font color="#000000"> (</font><font color="#660096">patch</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)<br />    </font><font color="#0000aa">repeat</font><font color="#000000"> </font><font color="#963700">36</font><font color="#000000">[<br />      </font><font color="#0000aa">let</font><font color="#000000"> temp-x </font><font color="#660096">xcor</font><font color="#000000"> <br />      </font><font color="#0000aa">let</font><font color="#000000"> temp-y </font><font color="#660096">ycor</font><font color="#000000"> <br />      </font><font color="#0000aa">right</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"><br />      </font><font color="#0000aa">while</font><font color="#000000"> [</font><font color="#660096">distancexy</font><font color="#000000"> temp-x temp-y </font><font color="#660096">&lt;</font><font color="#000000"> ((size-shape)</font><font color="#660096">/</font><font color="#000000">((</font><font color="#963700">pi</font><font color="#000000">)</font><font color="#660096">*</font><font color="#000000">(</font><font color="#963700">2</font><font color="#000000">)))][<br />        </font><font color="#0000aa">forward</font><font color="#000000"> </font><font color="#963700">0.001</font><font color="#000000"><br />        </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]<br />      ]<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> draw-star<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">[<br />    </font><font color="#0000aa">face</font><font color="#000000"> (</font><font color="#660096">patch</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)<br />    </font><font color="#0000aa">repeat</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000">[<br />      </font><font color="#0000aa">let</font><font color="#000000"> temp-x </font><font color="#660096">xcor</font><font color="#000000"> <br />      </font><font color="#0000aa">let</font><font color="#000000"> temp-y </font><font color="#660096">ycor</font><font color="#000000"> <br />      </font><font color="#0000aa">right</font><font color="#000000"> </font><font color="#963700">144</font><font color="#000000"><br />      </font><font color="#0000aa">while</font><font color="#000000"> [</font><font color="#660096">distancexy</font><font color="#000000"> temp-x temp-y </font><font color="#660096">&lt;</font><font color="#000000"> size-shape][<br />        </font><font color="#0000aa">forward</font><font color="#000000"> </font><font color="#963700">0.001</font><font color="#000000"><br />        </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]<br />      ]<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /></font>
</pre>
